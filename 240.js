/*! For license information please see 240.js.LICENSE.txt */
"use strict";(self.webpackChunkword_ai_assistant=self.webpackChunkword_ai_assistant||[]).push([[240],{4240(e,t,r){r.r(t),r.d(t,{ApiId:()=>w.sA,AuthError:()=>c.lR,AuthErrorCodes:()=>l,AuthenticationHeaderParser:()=>s,AuthenticationScheme:()=>me,AzureCloudInstance:()=>u._,BrowserAuthError:()=>v.jT,BrowserAuthErrorCodes:()=>U,BrowserCacheLocation:()=>w.Al,BrowserConfigurationAuthError:()=>M.X,BrowserConfigurationAuthErrorCodes:()=>I,BrowserPerformanceClient:()=>de,BrowserPerformanceMeasurement:()=>he.BrowserPerformanceMeasurement,BrowserRootPerformanceEvents:()=>q,BrowserUtils:()=>n,CacheLookupPolicy:()=>w.nN,ClientAuthError:()=>d.e,ClientAuthErrorCodes:()=>h,ClientConfigurationError:()=>a.q,ClientConfigurationErrorCodes:()=>i,DEFAULT_IFRAME_TIMEOUT_MS:()=>k.YH,EventHandler:()=>F.J,EventMessageUtils:()=>Z,EventType:()=>Y.B,InteractionRequiredAuthError:()=>p.CB,InteractionRequiredAuthErrorCodes:()=>m,InteractionStatus:()=>w.T$,InteractionType:()=>w.X8,JsonWebTokenTypes:()=>be,LocalStorage:()=>J.D,LogLevel:()=>f.$b,Logger:()=>f.Vy,MemoryStorage:()=>z.X,NavigationClient:()=>E.c,OIDC_DEFAULT_SCOPES:()=>ye,PromptValue:()=>ge,ProtocolMode:()=>g.e,PublicClientApplication:()=>C.vq,ResponseMode:()=>fe,ServerError:()=>b.g,SessionStorage:()=>Q.u,SignedHttpRequest:()=>re,StubPerformanceClient:()=>y.a,WrapperSKU:()=>w.f7,createNestablePublicClientApplication:()=>C.Ji,createStandardPublicClientApplication:()=>C.q8,isPlatformBrokerAvailable:()=>pe.gI,loadExternalTokens:()=>V,stubbedPublicClientApplication:()=>T,version:()=>te.r});var n=r(3841),o=r(5399),a=r(4906),i=r(2508);class s{constructor(e){this.headers=e}getShrNonce(){const e=this.headers[o.OK.AuthenticationInfo];if(e){const t=this.parseChallenges(e);if(t.nextnonce)return t.nextnonce;throw(0,a.a)(i.invalidAuthenticationHeader)}const t=this.headers[o.OK.WWWAuthenticate];if(t){const e=this.parseChallenges(t);if(e.nonce)return e.nonce;throw(0,a.a)(i.invalidAuthenticationHeader)}throw(0,a.a)(i.missingNonceAuthenticationHeader)}parseChallenges(e){const t=e.indexOf(" "),r=e.substr(t+1).split(","),n={};return r.forEach(e=>{const[t,r]=e.split("=");n[t]=unescape(r.replace(/['"]+/g,""))}),n}}var c=r(6313),l=r(8841),u=r(5851),d=r(4998),h=r(8504),p=r(62),m=r(80),f=r(9745),g=r(589),b=r(3328),y=r(8066),C=r(5032),k=r(481),w=r(5289),v=r(469),M=r(8045),I=r(8397);const T={initialize:()=>Promise.reject((0,M.j)(I.stubbedPublicClientApplicationCalled)),acquireTokenPopup:()=>Promise.reject((0,M.j)(I.stubbedPublicClientApplicationCalled)),acquireTokenRedirect:()=>Promise.reject((0,M.j)(I.stubbedPublicClientApplicationCalled)),acquireTokenSilent:()=>Promise.reject((0,M.j)(I.stubbedPublicClientApplicationCalled)),acquireTokenByCode:()=>Promise.reject((0,M.j)(I.stubbedPublicClientApplicationCalled)),getAllAccounts:()=>[],getAccount:()=>null,handleRedirectPromise:()=>Promise.reject((0,M.j)(I.stubbedPublicClientApplicationCalled)),loginPopup:()=>Promise.reject((0,M.j)(I.stubbedPublicClientApplicationCalled)),loginRedirect:()=>Promise.reject((0,M.j)(I.stubbedPublicClientApplicationCalled)),logoutRedirect:()=>Promise.reject((0,M.j)(I.stubbedPublicClientApplicationCalled)),logoutPopup:()=>Promise.reject((0,M.j)(I.stubbedPublicClientApplicationCalled)),ssoSilent:()=>Promise.reject((0,M.j)(I.stubbedPublicClientApplicationCalled)),addEventCallback:()=>null,removeEventCallback:()=>{},addPerformanceCallback:()=>"",removePerformanceCallback:()=>!1,getLogger:()=>{throw(0,M.j)(I.stubbedPublicClientApplicationCalled)},setLogger:()=>{},setActiveAccount:()=>{},getActiveAccount:()=>null,initializeWrapperLibrary:()=>{},setNavigationClient:()=>{},getConfiguration:()=>{throw(0,M.j)(I.stubbedPublicClientApplicationCalled)},hydrateCache:()=>Promise.reject((0,M.j)(I.stubbedPublicClientApplicationCalled)),clearCache:()=>Promise.reject((0,M.j)(I.stubbedPublicClientApplicationCalled))};var E=r(602),A=r(3139),P=r(8175),S=r(2515),B=r(76),_=r(1690),N=r(313),O=r(5452),x=r(4792),R=r(8546),j=r(8008),$=r(6114),D=r(2077),L=r(9347),F=r(8035),q=r(3545),H=r(1717),U=r(7749);async function V(e,t,r,o,a=new y.a){(0,n.blockNonBrowserEnvironment)();const i=(0,k.tD)(e,!0),s=t.correlationId||(0,D.Oy)(),c=a.startMeasurement(q.LoadExternalTokens,s);try{const n=r.id_token?A.My(r.id_token,$.u):void 0,l=A.XB(n||{}),u={protocolMode:i.system.protocolMode,knownAuthorities:i.auth.knownAuthorities,cloudDiscoveryMetadata:i.auth.cloudDiscoveryMetadata,authorityMetadata:i.auth.authorityMetadata},d=new f.Vy(i.system.loggerOptions||{}),h=new L.M(d,i.telemetry.client),p=new j.c(i.auth.clientId,i.cache,h,d,i.telemetry.client,new F.J(d),(0,P.aw)(i.auth)),m=t.authority||i.auth.authority,g=await S.Y(P.s4.generateAuthority(m,t.azureCloudOptions),i.system.networkClient,p,u,d,s,a),b=await(0,B.T)(W,H.ii,d,a,s)(t,o.clientInfo||r.client_info||"",s,p,d,h,g,n),y=await(0,B.T)(G,H.lO,d,a,s)(r,b.homeAccountId,b.environment,b.realm,l,s,p,d,e.auth.clientId),C=await(0,B.T)(K,H.QF,d,a,s)(t,r,b.homeAccountId,b.environment,b.realm,l,o,s,p,d,e.auth.clientId),k=await(0,B.T)(X,H.v7,d,a,s)(r,b.homeAccountId,b.environment,l,s,p,d,e.auth.clientId,a);return c.end({success:!0},void 0,_.Gf(b)),function(e,t,r,n){let o,a="",i=[],s=null;t?.accessToken&&(a=t.accessToken.secret,i=x.l.fromString(t.accessToken.target).asArray(),s=R.dM(t.accessToken.expiresOn),o=R.dM(t.accessToken.extendedExpiresOn));const c=t.account;return{authority:r.canonicalAuthority,uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:i,account:_.Gf(c),idToken:t.idToken?.secret||"",idTokenClaims:n||{},accessToken:a,fromCache:!0,expiresOn:s,correlationId:e.correlationId||"",requestId:"",extExpiresOn:o,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromPlatformBroker:!1}}(t,{account:b,idToken:y,accessToken:C,refreshToken:k},g,n)}catch(e){throw c.end({success:!1},e),e}}async function W(e,t,r,n,o,a,i,s){if(o.verbose("0ke46k",r),e.account){const t=_.UE(e.account);return await n.setAccount(t,r,A.XB(s||{}),w.sA.loadExternalTokens),t}if(!t&&!s)throw o.error("0hzcn4",r),(0,v.bD)(U.unableToLoadToken);const c=_.nD(t,i.authorityType,o,a,r,s),l=s?.tid,u=(0,N.J)(n,i,c,$.u,r,s,t,i.getPreferredCache(),l,void 0,void 0,o);return await n.setAccount(u,r,A.XB(s||{}),w.sA.loadExternalTokens),u}async function G(e,t,r,n,o,a,i,s,c){if(!e.id_token)return s.verbose("1pm7g1",a),null;s.verbose("168lyi",a);const l=O.c_(t,r,e.id_token,c,n);return await i.setIdTokenCredential(l,a,o),l}async function K(e,t,r,n,o,a,i,s,c,l,u){if(!t.access_token)return l.verbose("1ckp9e",s),null;if(!t.expires_in)return l.error("15mzx8",s),null;if(!(t.scope||e.scopes&&e.scopes.length))return l.error("1h7xse",s),null;l.verbose("01kmxb",s);const d=t.scope?x.l.fromString(t.scope):new x.l(e.scopes),h=i.expiresOn||t.expires_in+R._C(),p=i.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+R._C(),m=O.Np(r,n,t.access_token,u,o,d.printScopes(),h,p,$.u);return await c.setAccessTokenCredential(m,s,a),m}async function X(e,t,r,n,o,a,i,s,c){if(!e.refresh_token)return i.verbose("1l7um5",o),null;const l=e.refresh_token_expires_in?e.refresh_token_expires_in+R._C():void 0;c.addFields({extRtExpiresOnSeconds:l},o),i.verbose("0qy8ev",o);const u=O.Mg(t,r,e.refresh_token,s,e.foci,void 0,l);return await a.setRefreshTokenCredential(u,o,n),u}var z=r(9399),J=r(2725),Q=r(5050),Y=r(2413);class Z{static getInteractionStatusFromEvent(e,t){switch(e.eventType){case Y.B.ACQUIRE_TOKEN_START:if(e.interactionType===w.X8.Redirect||e.interactionType===w.X8.Popup)return w.T$.AcquireToken;break;case Y.B.HANDLE_REDIRECT_START:return w.T$.HandleRedirect;case Y.B.LOGOUT_START:return w.T$.Logout;case Y.B.LOGOUT_END:if(t&&t!==w.T$.Logout)break;return w.T$.None;case Y.B.HANDLE_REDIRECT_END:if(t&&t!==w.T$.HandleRedirect)break;return w.T$.None;case Y.B.ACQUIRE_TOKEN_SUCCESS:case Y.B.ACQUIRE_TOKEN_FAILURE:case Y.B.RESTORE_FROM_BFCACHE:if(e.interactionType===w.X8.Redirect||e.interactionType===w.X8.Popup){if(t&&t!==w.T$.AcquireToken)break;return w.T$.None}}return null}}var ee=r(2635),te=r(1339);class re{constructor(e,t){const r=t&&t.loggerOptions||{};this.logger=new f.Vy(r,te.U,te.r),this.cryptoOps=new L.M(this.logger),this.popTokenGenerator=new ee.Q(this.cryptoOps,new y.a),this.shrParameters=e}async generatePublicKeyThumbprint(){const{kid:e}=await this.popTokenGenerator.generateKid(this.shrParameters);return e}async signRequest(e,t,r){return this.popTokenGenerator.signPayload(e,t,this.shrParameters,r)}async removeKeys(e,t){return this.cryptoOps.removeTokenBindingKey(e,t)}}var ne=r(1861),oe=r(4815);function ae(e){const t=e.lastIndexOf(" ")+1;if(t<1)return e;const r=e.substring(t);let n=r.lastIndexOf("/");return n=n<0?r.lastIndexOf("\\"):n,n>=0?(e.substring(0,t)+"("+r.substring(n+1)+(")"===r.charAt(r.length-1)?"":")")).trimStart():e.trimStart()}class ie{constructor(e,t,r,n,o,a,i){this.authority=t,this.libraryName=n,this.libraryVersion=o,this.applicationTelemetry=a,this.clientId=e,this.logger=r,this.callbacks=new Map,this.eventsByCorrelationId=new Map,this.eventStack=new Map,this.intFields=i||new Set;for(const e of ne.H)this.intFields.add(e)}startMeasurement(e,t){const r=t||this.generateId(),n={eventId:this.generateId(),status:ne.h.InProgress,authority:this.authority,libraryName:this.libraryName,libraryVersion:this.libraryVersion,clientId:this.clientId,name:e,startTimeMs:Date.now(),correlationId:r,appName:this.applicationTelemetry?.appName,appVersion:this.applicationTelemetry?.appVersion};var o,a;return this.cacheEventByCorrelationId(n),o=n,(a=this.eventStack.get(r))&&a.push({name:o.name}),{end:(e,t,r)=>this.endMeasurement({...n,...e},t,r),discard:()=>this.discardMeasurements(n.correlationId),add:e=>this.addFields(e,n.correlationId),increment:e=>this.incrementFields(e,n.correlationId),event:n}}endMeasurement(e,t,r){const n=this.eventsByCorrelationId.get(e.correlationId);if(!n)return this.logger.trace("0k9ti8",e.correlationId),null;const o=e.eventId===n.eventId;e.durationMs=Math.round(e.durationMs||this.getDurationMs(e.startTimeMs));const a=JSON.stringify(function(e,t,r){if(!t?.length)return;const n=e=>e.length?e[e.length-1]:void 0,o=e.name,a=n(t);if(a?.name!==o)return;const i=t?.pop();if(!i)return;const s=r instanceof c.lR?r.errorCode:r instanceof Error?r.name:void 0,l=r instanceof c.lR?r.subError:void 0;s&&i.childErr!==s&&(i.err=s,l&&(i.subErr=l)),delete i.name,delete i.childErr;const u={...i,dur:e.durationMs};e.success||(u.fail=1);const d=n(t);if(!d)return{[o]:u};let h;if(s&&(d.childErr=s),d[o]){const e=Object.keys(d).filter(e=>e.startsWith(o)).length;h=`${o}_${e+1}`}else h=o;return d[h]=u,d}(e,this.eventStack.get(n.correlationId),t));if(o?this.discardMeasurements(n.correlationId):n.incompleteSubMeasurements?.delete(e.eventId),t&&function(e,t,r,n=5){if(e instanceof Error)return e instanceof c.lR?(r.errorCode=e.errorCode,r.subErrorCode=e.subError,void((e instanceof b.g||e instanceof p.CB)&&(r.serverErrorNo=e.errorNo))):void(e instanceof oe.xA?r.errorCode=e.errorCode:r.errorStack?.length?t.trace("0lmqrh",r.correlationId):e.stack?.length?(e.stack&&(r.errorStack=function(e,t){if(t<0)return[];const r=e.split("\n")||[],n=[],o=r[0];o.startsWith("TypeError: Cannot read property")||o.startsWith("TypeError: Cannot read properties of")||o.startsWith("TypeError: Cannot set property")||o.startsWith("TypeError: Cannot set properties of")||o.endsWith("is not a function")?n.push(ae(o)):(o.startsWith("SyntaxError")||o.startsWith("TypeError"))&&n.push(ae(o.replace(/['].*[']|["].*["]/g,"<redacted>")));for(let e=1;e<r.length&&!(n.length>=t);e++){const t=r[e];n.push(ae(t))}return n}(e.stack,n)),r.errorName=e.name):t.trace("1cnpwa",r.correlationId));t.trace("0gcyox",r.correlationId)}(t,this.logger,n),!o)return n[e.name+"DurationMs"]=Math.floor(e.durationMs),{...n};o&&!t&&(n.errorCode||n.subErrorCode)&&(this.logger.trace("1fm1tm",e.correlationId),n.errorCode=void 0,n.subErrorCode=void 0);let i={...n,...e},s=0;i.incompleteSubMeasurements?.forEach(e=>{this.logger.trace("0nxk52",i.correlationId),s++}),i.incompleteSubMeasurements=void 0;const l=(0,f.hy)(e.correlationId).map(e=>`${e.milliseconds},${e.hash}`).join(";");return i={...i,status:ne.h.Completed,incompleteSubsCount:s,context:a,logs:l},r&&(i.accountType=function(e){const t=e?.idTokenClaims;return t?.tfp||t?.acr?"B2C":t?.tid?"9188040d-6c67-4c5b-b112-36a304b66dad"===t?.tid?"MSA":"AAD":void 0}(r),i.dataBoundary=r.dataBoundary),this.truncateIntegralFields(i),this.emitEvents([i],e.correlationId),i}addFields(e,t){const r=this.eventsByCorrelationId.get(t);r?this.eventsByCorrelationId.set(t,{...r,...e}):this.logger.trace("0thl6s",t)}incrementFields(e,t){const r=this.eventsByCorrelationId.get(t);if(r)for(const t in e){if(r.hasOwnProperty(t)){if(isNaN(Number(r[t])))return}else r[t]=0;r[t]+=e[t]}else this.logger.trace("0thl6s",t)}cacheEventByCorrelationId(e){const t=this.eventsByCorrelationId.get(e.correlationId);t?(t.incompleteSubMeasurements=t.incompleteSubMeasurements||new Map,t.incompleteSubMeasurements.set(e.eventId,{name:e.name,startTimeMs:e.startTimeMs})):(this.eventsByCorrelationId.set(e.correlationId,{...e}),this.eventStack.set(e.correlationId,[]))}discardMeasurements(e){this.eventsByCorrelationId.delete(e),this.eventStack.delete(e)}addPerformanceCallback(e){for(const[t,r]of this.callbacks)if(r.toString()===e.toString())return this.logger.warning("1eap5p",""),t;const t=this.generateId();return this.callbacks.set(t,e),this.logger.verbose("0c9ujz",""),t}removePerformanceCallback(e){const t=this.callbacks.delete(e);return t?this.logger.verbose("0253if",""):this.logger.verbose("0iqk07",""),t}emitEvents(e,t){this.logger.verbose("11jb1y",t),this.callbacks.forEach((r,n)=>{this.logger.trace("0p2pjl",t),r.apply(null,[e])})}truncateIntegralFields(e){this.intFields.forEach(t=>{t in e&&"number"==typeof e[t]&&(e[t]=Math.floor(e[t]))})}getDurationMs(e){const t=Date.now()-e;return t<0?t:0}}var se=r(2689);function ce(){let e;try{e=window[w.Al.SessionStorage];const t=e?.getItem(se.Fi);if(1===Number(t))return Promise.resolve().then(r.bind(r,9162))}catch(e){}}function le(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.now}function ue(e){if(e&&le())return Math.round(window.performance.now()-e)}class de extends ie{constructor(e,t){super(e.auth.clientId,e.auth.authority||`${o.Md}`,new f.Vy(e.system?.loggerOptions||{},te.U,te.r),te.U,te.r,e.telemetry?.application||{appName:"",appVersion:""},t)}generateId(){return(0,D.Oy)()}getPageVisibility(){return document.visibilityState?.toString()||null}deleteIncompleteSubMeasurements(e){ce()?.then(t=>{const r=this.eventsByCorrelationId.get(e.event.correlationId),n=r&&r.eventId===e.event.eventId,o=[];n&&r?.incompleteSubMeasurements&&r.incompleteSubMeasurements.forEach(e=>{o.push({...e})}),t.BrowserPerformanceMeasurement.flushMeasurements(e.event.correlationId,o)})}startMeasurement(e,t){const r=this.getPageVisibility(),n=super.startMeasurement(e,t),o=le()?window.performance.now():void 0,a=ce()?.then(t=>new t.BrowserPerformanceMeasurement(e,n.event.correlationId));return a?.then(e=>e.startMeasurement()),{...n,end:(e,t,i)=>{const s=n.end({...e,startPageVisibility:r,endPageVisibility:this.getPageVisibility(),durationMs:ue(o)},t,i);return a?.then(e=>e.endMeasurement()),this.deleteIncompleteSubMeasurements(n),s},discard:()=>{n.discard(),a?.then(e=>e.flushMeasurement()),this.deleteIncompleteSubMeasurements(n)}}}}var he=r(9162),pe=r(867);const me=o.IO,fe=o.p,ge=o.Hp,be=o.Lz,ye=o.aZ},9162(e,t,r){r.r(t),r.d(t,{BrowserPerformanceMeasurement:()=>n});class n{constructor(e,t){this.correlationId=t,this.measureName=n.makeMeasureName(e,t),this.startMark=n.makeStartMark(e,t),this.endMark=n.makeEndMark(e,t)}static makeMeasureName(e,t){return`msal.measure.${e}.${t}`}static makeStartMark(e,t){return`msal.start.${e}.${t}`}static makeEndMark(e,t){return`msal.end.${e}.${t}`}static supportsBrowserPerformance(){return"undefined"!=typeof window&&void 0!==window.performance&&"function"==typeof window.performance.mark&&"function"==typeof window.performance.measure&&"function"==typeof window.performance.clearMarks&&"function"==typeof window.performance.clearMeasures&&"function"==typeof window.performance.getEntriesByName}static flushMeasurements(e,t){if(n.supportsBrowserPerformance())try{t.forEach(t=>{const r=n.makeMeasureName(t.name,e);window.performance.getEntriesByName(r,"measure").length>0&&(window.performance.clearMeasures(r),window.performance.clearMarks(n.makeStartMark(r,e)),window.performance.clearMarks(n.makeEndMark(r,e)))})}catch(e){}}startMeasurement(){if(n.supportsBrowserPerformance())try{window.performance.mark(this.startMark)}catch(e){}}endMeasurement(){if(n.supportsBrowserPerformance())try{window.performance.mark(this.endMark),window.performance.measure(this.measureName,this.startMark,this.endMark)}catch(e){}}flushMeasurement(){if(n.supportsBrowserPerformance())try{const e=window.performance.getEntriesByName(this.measureName,"measure");if(e.length>0){const t=e[0].duration;return window.performance.clearMeasures(this.measureName),window.performance.clearMarks(this.startMark),window.performance.clearMarks(this.endMark),t}}catch(e){}return null}}}}]);